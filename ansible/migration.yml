---
- hosts: all
  remote_user: "{{ ansible_user }}"

  vars_files:
    - vars.yml

  tasks:
    - name: Insert monoments data to database
      ansible.builtin.shell:
        cmd: |
          "python {{ item }}"
        chdir: /opt/git/open-monuments-map
        executable: /opt/git/open-monuments-map/venv/bin/python
      with_items:
        - "insert_boundaries.py /opt/git/open-monuments-map/data/monument_boundaries.geojson"
        - "insert_monuments.py /opt/git/open-monuments-map/data/stadt-flensburg-denkmalschutz.geojson"

    - name: Run a script using an executable in a system path
      ansible.builtin.shell:
        cmd: |
          "python {{ item }}"
        chdir: /opt/git/open-monuments-map
        executable: /opt/git/open-monuments-map/venv/bin/python
      with_items:
        - "insert_boundaries.py /opt/git/open-monuments-map/data/monument_boundaries.geojson"
        - "insert_monuments.py /opt/git/open-monuments-map/data/stadt-flensburg-denkmalschutz.geojson"
